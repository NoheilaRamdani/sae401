<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Calendrier des tâches{% endblock %}</title>
    <link rel="icon" type="image/png" href="{{ asset('img/logo_intranet_iut_troyes.png') }}">
    <link rel="icon" type="image/png" href="{{ asset('img/favicon-96x96.png') }}" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="{{ asset('img/favicon.svg') }}" />
    <link rel="shortcut icon" href="{{ asset('img/favicon.ico') }}" />
    <link rel="apple-touch-icon" sizes="180x180" href="{{ asset('img/apple-touch-icon.png') }}" />
    <meta name="apple-mobile-web-app-title" content="Agenda MMI" />
    <link rel="manifest" href="{{ asset('img/site.webmanifest') }}" />
    <meta name="description" content="{% block description %}Découvrez l’agenda MMI pour gérer vos devoirs et organiser vos tâches !{% endblock %}">

    <!-- Préconnexion aux domaines de Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Chargement non bloquant de la feuille de style -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" media="print" onload="this.media='all'">



    {% block stylesheets %}
        <link rel="stylesheet" href="{{ asset('styles/css/app.css') }}">
        <link
                rel="stylesheet"
                href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
                integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
                crossorigin="anonymous"
                referrerpolicy="no-referrer"
        />
        {# Commenté pour Bootstrap CSS, à décommenter si besoin ultérieurement #}
        {# <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"> #}
    {% endblock %}

    {% block javascripts %}
        {% block importmap %}
            {{ importmap('app') }}
        {% endblock %}
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>
    {% endblock %}
</head>
<body>
<nav class="row-spacebtwn">
    <a class="logo" href="{{ path('app_home') }}"><img class="logo" src="{{ asset('img/logo_intranet_iut_troyes.svg') }}" alt="Logo de l'Intranet de Troyes"></a>
    <div class="burger" id="burger">
        <span></span>
        <span></span>
        <span></span>
    </div>
    <ul id="navLinks" class="links">
        <li class="row-center {{ app.request.get('_route') == 'app_home' ? 'active' : '' }}">
            <a class="row-center" href="{{ path('app_home') }}"><i class="fa-solid fa-calendar-days"></i> Calendrier</a>
        </li>
        <li class="row-center separator"></li>
        {% if is_granted('ROLE_ADMIN') %}
            <li class="row-center {{ app.request.get('_route') == 'delegate_manage' ? 'active' : '' }}">
                <a class="row-center" href="{{ path('delegate_manage') }}">
                    <svg class="icon" viewBox="0 0 24 26" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17.009 14.08C18.8976 14.9715 20.5079 16.3602 21.6673 18.0972C22.8267 19.8343 23.4914 21.8541 23.5902 23.9402C23.6034 24.1313 23.5782 24.3231 23.5162 24.5043C23.4543 24.6855 23.3567 24.8526 23.2293 24.9956C23.1019 25.1386 22.9473 25.2548 22.7744 25.3372C22.6015 25.4196 22.4139 25.4667 22.2225 25.4756C22.0312 25.4846 21.84 25.4552 21.6602 25.3893C21.4804 25.3233 21.3155 25.2221 21.1754 25.0916C21.0352 24.9611 20.9225 24.8039 20.8439 24.6292C20.7653 24.4545 20.7224 24.2659 20.7177 24.0744C20.6131 21.8587 19.6593 19.7683 18.0543 18.2373C16.4493 16.7062 14.3163 15.852 12.0981 15.852C9.87993 15.852 7.74693 16.7062 6.14191 18.2373C4.53688 19.7683 3.58311 21.8587 3.47857 24.0744C3.45274 24.4495 3.28108 24.7995 3.00036 25.0495C2.71964 25.2996 2.35217 25.4298 1.97665 25.4122C1.60112 25.3947 1.2474 25.2308 0.991218 24.9557C0.735038 24.6805 0.596772 24.316 0.606027 23.9402C0.704648 21.8543 1.36909 19.8346 2.52811 18.0976C3.68714 16.3606 5.29705 14.9718 7.18526 14.08C5.97529 13.0707 5.10557 11.7133 4.69442 10.1922C4.28326 8.67119 4.35063 7.06041 4.88735 5.57902C5.42407 4.09762 6.4041 2.81751 7.69412 1.91282C8.98413 1.00812 10.5215 0.522766 12.0971 0.522766C13.6728 0.522766 15.2102 1.00812 16.5002 1.91282C17.7902 2.81751 18.7702 4.09762 19.307 5.57902C19.8437 7.06041 19.911 8.67119 19.4999 10.1922C19.0887 11.7133 18.219 13.0707 17.009 14.08ZM16.8921 8.18725C16.8921 6.91581 16.387 5.69645 15.488 4.79741C14.5889 3.89837 13.3695 3.39329 12.0981 3.39329C10.8267 3.39329 9.60731 3.89837 8.70827 4.79741C7.80923 5.69645 7.30415 6.91581 7.30415 8.18725C7.30415 9.45869 7.80923 10.678 8.70827 11.5771C9.60731 12.4761 10.8267 12.9812 12.0981 12.9812C13.3695 12.9812 14.5889 12.4761 15.488 11.5771C16.387 10.678 16.8921 9.45869 16.8921 8.18725Z" fill="#4D3677"/>
                    </svg> Gestion des délégués</a>
            </li>
            <li class="row-center separator"></li>
            <li class="row-center {{ app.request.get('_route') == 'manage_assignments' ? 'active' : '' }}">
                <a class="row-center" href="{{ path('manage_assignments') }}">
                    <svg class="icon" viewBox="0 0 26 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M10.8525 0C11.6859 0 12.5192 0.30963 13.3525 0.928889C14.1859 0.30963 15.0192 0 15.8525 0H23.3525C24.0156 0 24.6515 0.257539 25.1203 0.715961C25.5891 1.17438 25.8525 1.79614 25.8525 2.44444V18.3333C25.8525 18.9816 25.5891 19.6034 25.1203 20.0618C24.6515 20.5202 24.0156 20.7778 23.3525 20.7778H14.6025C14.6025 21.4524 14.04 22 13.3525 22C12.665 22 12.1025 21.45 12.1025 20.7778H3.35254C2.6895 20.7778 2.05361 20.5202 1.58477 20.0618C1.11593 19.6034 0.852539 18.9816 0.852539 18.3333V2.44444C0.852539 1.79614 1.11593 1.17438 1.58477 0.715961C2.05361 0.257539 2.6895 0 3.35254 0H10.8525ZM10.8525 2.44444H3.35254V18.3333H12.1025V3.66667C12.1025 2.99444 11.54 2.44444 10.8525 2.44444ZM23.3525 2.44444H15.8525C15.165 2.44444 14.6025 2.99444 14.6025 3.66667V18.3333H23.3525V2.44444Z" fill="white"/>
                    </svg> Gestion des tâches</a>
            </li>
            <li class="row-center separator"></li>
            <li class="row-center {{ app.request.get('_route') == 'add_assignment' ? 'active' : '' }}">
                <a class="row-center" href="{{ path('add_assignment') }}"><i class="fa-solid fa-plus"></i> Ajouter une tâche</a>
            </li>
            <li class="row-center separator"></li>
        {% elseif is_granted('ROLE_DELEGATE') %}
            <li class="row-center {{ app.request.get('_route') == 'manage_assignments' ? 'active' : '' }}">
                <a class="row-center" href="{{ path('manage_assignments') }}">
                    <svg class="icon" viewBox="0 0 26 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M10.8525 0C11.6859 0 12.5192 0.30963 13.3525 0.928889C14.1859 0.30963 15.0192 0 15.8525 0H23.3525C24.0156 0 24.6515 0.257539 25.1203 0.715961C25.5891 1.17438 25.8525 1.79614 25.8525 2.44444V18.3333C25.8525 18.9816 25.5891 19.6034 25.1203 20.0618C24.6515 20.5202 24.0156 20.7778 23.3525 20.7778H14.6025C14.6025 21.4524 14.04 22 13.3525 22C12.665 22 12.1025 21.45 12.1025 20.7778H3.35254C2.6895 20.7778 2.05361 20.5202 1.58477 20.0618C1.11593 19.6034 0.852539 18.9816 0.852539 18.3333V2.44444C0.852539 1.79614 1.11593 1.17438 1.58477 0.715961C2.05361 0.257539 2.6895 0 3.35254 0H10.8525ZM10.8525 2.44444H3.35254V18.3333H12.1025V3.66667C12.1025 2.99444 11.54 2.44444 10.8525 2.44444ZM23.3525 2.44444H15.8525C15.165 2.44444 14.6025 2.99444 14.6025 3.66667V18.3333H23.3525V2.44444Z" fill="white"/>
                    </svg> Gestion des tâches</a>
            </li>
            <li class="row-center separator"></li>
            <li class="row-center {{ app.request.get('_route') == 'add_assignment' ? 'active' : '' }}">
                <a class="row-center" href="{{ path('add_assignment') }}"><i class="fa-solid fa-plus"></i> Ajouter une tâche</a>
            </li>
            <li class="row-center separator"></li>
            <li class="row-center {{ app.request.get('_route') == 'app_suggestions' ? 'active' : '' }}">
                <a class="row-center" href="{{ path('app_suggestions') }}"><i class="fa-solid fa-pencil"></i>Suggestions de modification</a>
            </li>
            <li class="row-center separator"></li>
        {% endif %}
        {% if not is_granted('IS_AUTHENTICATED_FULLY') %}
            <li class="row-center">
                <a class="row-center" href="{{ path('app_register') }}">Inscription</a>
            </li>
            <li class="row-center separator"></li>
            <li class="row-center">
                <a class="row-center" href="{{ path('app_login') }}">Connexion</a>
            </li>
        {% else %}
            {# <li class="row-center">
                <a class="row-center" href="{{ path('ical_user_feed') }}" target="_blank">Ajouter à mon calendrier</a>
            </li>
            <li class="row-center separator"></li> #}
            <li class="row-center {{ app.request.get('_route') == 'app_assignments_history' ? 'active' : '' }}">
                <a class="row-center" href="{{ path('app_assignments_history') }}"><i class="fa-solid fa-clock-rotate-left"></i> Toutes les tâches</a>
            </li>
            <li class="row-center separator"></li>
            {# Ajout du lien iCal pour ROLE_DELEGATE et ROLE_USER uniquement #}
            {% if is_granted('ROLE_DELEGATE') or not is_granted('ROLE_ADMIN') %}
                <li class="row-center">
                    <a class="row-center" href="{{ path('ical_user_feed') }}" title="Exporter vers calendrier"><i class="fa-solid fa-calendar-plus"></i> iCal</a>
                </li>
                <li class="row-center separator"></li>
            {% endif %}
            <li class="row-center">
                <a class="row-center" href="{{ path('app_logout') }}"><i class="fa-solid fa-arrow-right-from-bracket"></i></a>
            </li>
        {% endif %}
    </ul>
</nav>
<div>
    {% for label, messages in app.flashes %}
        {% for message in messages %}
            <div class="popup">
                {{ message }}
            </div>
        {% endfor %}
    {% endfor %}
</div>
{% block body %}{% endblock %}
</body>
</html>